# **2.2 일관성(Consistency)**

분산 시스템에서 여러 노드가 동일한 데이터를 어떤 수준으로 보장할 것인지 결정하는 속성.

---

### **1. 강한 일관성 (Strong Consistency)**

**정의**

- 모든 읽기(Read)는 반드시 “가장 최근에 성공한 쓰기(Write)” 값을 반환해야 한다.
- 쓰기 후 즉시 모든 노드가 최신 상태여야 한다.

**동작 방식**

- 리더(Primary) 노드가 쓰기·읽기를 책임짐
- 레플리카는 **동기 복제(Synchronous Replication)**
- 모든 레플리카가 반영되기 전에는 읽기를 차단하거나 오류 반환

**장점**

- 데이터 정합성이 100% 보장됨
- 은행, 결제, 예약처럼 오류가 허용되지 않는 서비스에 적합

**단점**

- 지연(latency)이 증가할 수 있음
- 리더 장애 시 전체 가용성 저하 (Failover 필요)

---

### **2. 최종 일관성 (Eventual Consistency)**

### 정의

- 일시적으로 노드마다 다른 값을 가질 수 있지만, 시간이 지나면 동일한 값으로 수렴한다.

### **동작 방식**

- 레플리카는 **비동기 복제(Asynchronous Replication)**
- 글로벌 분산 구조에서 기본적으로 선택되는 방식
- 데이터 불일치가 순간적으로 발생해도 무방한 경우에 사용

### **장점**

- 지연 시간 감소
- 높은 쓰기 성능
- 장애에 강함
- 수평 확장에 유리하여 대규모 시스템에서 널리 사용됨

### **단점**

- 읽은 값이 최신 값이 아닐 수 있음
- 사용자 경험 차원에서 “왜 갱신 안됐지?” 같은 의문이 생길 수 있음

---

## **3. 강한 일관성과 최종 일관성의 트레이드오프**

| **일관성 수준** | **장점** | **단점** | **주 사용 사례** |
| --- | --- | --- | --- |
| 강한 일관성 | 정확한 데이터 보장 | 지연 증가, 가용성 저하 | 금융, 결제, 예약 |
| 최종 일관성 | 빠른 처리·고확장성 | 순간적 불일치 발생 | SNS, 로그, 캐시 |

### **비즈니스 요구 기반 의사결정 기준**

### **1) 데이터 불일치가 비즈니스적으로 허용되는가?**

- 허용 안 됨 → 강한 일관성
- 허용됨 → 최종 일관성

### **2) 응답 속도가 중요한가, 정확도가 중요한가?**

- 응답 속도 > 정확도 → 최종 일관성
- 정확도 > 응답 속도 → 강한 일관성

### **3) 서비스 구조는 어떤가?**

- 다중 Region/글로벌 서비스 → 최종 일관성
- 단일 Region + 높은 정확도 요구 → 강한 일관성